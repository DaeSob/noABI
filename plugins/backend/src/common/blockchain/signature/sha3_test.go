package signature

import (
	"cia/common/utils"
	"testing"

	solsha3 "github.com/miguelmota/go-solidity-sha3"

	// testify assert
	"github.com/stretchr/testify/assert"
)

func Test_Solsha3Bytes1(t *testing.T) {
	hash := solsha3.SoliditySHA3(
		solsha3.Bytes32("0x000000000000000000000000b171fe0b0804651446a50344ae14e56596190bcf000000000000000000000000fc662e967d2054973b3982bc3ae82fc40a168034000000000000000000000000000000000000000000000000000000000000000b0000000000000000000000000000000000000000000000000000000000000063"),
	)

	expectedHash := "0x5c7b8d623563f081aa6c7509824a7c7112ca76672f287a36ef092c9cab7b4803"

	println("got", utils.BytesToHexString(hash))
	println("want", expectedHash)
	assert.Equal(
		t,
		utils.BytesToHexString(hash),
		expectedHash,
	)
}

func Test_Solsha3Bytes2(t *testing.T) {
	hash := solsha3.SoliditySHA3(
		solsha3.Bytes32("0x000000000000000000000000b171fe0b0804651446a50344ae14e56596190bcf000000000000000000000000fc662e967d2054973b3982bc3ae82fc40a1680340000000000000000000000005f52c8dfcf920d1d4ab5cf03025fd9ce4a85d77b000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000000630000000000000000000000000000000000000000000000000000000000000042"),
	)

	expectedHash := "0xbb5c2f8555ffab2891ecda1abeb2435e098906fc553c93ad7aaae770f0052b05"

	println("got", utils.BytesToHexString(hash))
	println("want", expectedHash)
	assert.Equal(
		t,
		utils.BytesToHexString(hash),
		expectedHash,
	)
}

func Test_Bytes(t *testing.T) {
	hash := solsha3.SoliditySHA3(
		Bytes("0x000000000000000000000000b171fe0b0804651446a50344ae14e56596190bcf000000000000000000000000fc662e967d2054973b3982bc3ae82fc40a1680340000000000000000000000005f52c8dfcf920d1d4ab5cf03025fd9ce4a85d77b000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000000630000000000000000000000000000000000000000000000000000000000000042"),
	)

	expectedHash := "0xbb5c2f8555ffab2891ecda1abeb2435e098906fc553c93ad7aaae770f0052b05"

	println("got", utils.BytesToHexString(hash))
	println("want", expectedHash)
	assert.Equal(
		t,
		utils.BytesToHexString(hash),
		expectedHash,
	)
}
